<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_33) on Mon Jul 29 11:18:17 VET 2013 -->
<TITLE>
TypeAdapterFactory
</TITLE>

<META NAME="date" CONTENT="2013-07-29">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="TypeAdapterFactory";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.netmera.mobile.util.google.gson</FONT>
<BR>
Interface TypeAdapterFactory</H2>
<DL>
<DT><B>All Known Implementing Classes:</B> <DD><A HREF="../../../../../../com/netmera/mobile/util/google/gson/internal/bind/CollectionTypeAdapterFactory.html" title="class in com.netmera.mobile.util.google.gson.internal.bind">CollectionTypeAdapterFactory</A>, <A HREF="../../../../../../com/netmera/mobile/util/google/gson/internal/Excluder.html" title="class in com.netmera.mobile.util.google.gson.internal">Excluder</A>, <A HREF="../../../../../../com/netmera/mobile/util/google/gson/internal/bind/MapTypeAdapterFactory.html" title="class in com.netmera.mobile.util.google.gson.internal.bind">MapTypeAdapterFactory</A>, <A HREF="../../../../../../com/netmera/mobile/util/google/gson/internal/bind/ReflectiveTypeAdapterFactory.html" title="class in com.netmera.mobile.util.google.gson.internal.bind">ReflectiveTypeAdapterFactory</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public interface <B>TypeAdapterFactory</B></DL>
</PRE>

<P>
Creates type adapters for set of related types. Type adapter factories are
 most useful when several types share similar structure in their JSON form.

 <h3>Example: Converting enums to lowercase</h3>
 In this example, we implement a factory that creates type adapters for all
 enums. The type adapters will write enums in lowercase, despite the fact
 that they're defined in <code>CONSTANT_CASE</code> in the corresponding Java
 model: <pre>   <code>public class LowercaseEnumTypeAdapterFactory implements TypeAdapter.Factory {
     public &lt;T&gt; TypeAdapter&lt;T&gt; create(Gson gson, TypeToken&lt;T&gt; type) {
       Class&lt;T&gt; rawType = (Class&lt;T&gt;) type.getRawType();
       if (!rawType.isEnum()) {
         return null;
       }

       final Map&lt;String, T&gt; lowercaseToConstant = new HashMap&lt;String, T&gt;();
       for (T constant : rawType.getEnumConstants()) {
         lowercaseToConstant.put(toLowercase(constant), constant);
       }

       return new TypeAdapter&lt;T&gt;() {
         public void write(JsonWriter out, T value) throws IOException {
           if (value == null) {
             out.nullValue();
           } else {
             out.value(toLowercase(value));
           }
         }

         public T read(JsonReader reader) throws IOException {
           if (reader.peek() == JsonToken.NULL) {
             reader.nextNull();
             return null;
           } else {
             return lowercaseToConstant.get(reader.nextString());
           }
         }
       };
     }

     private String toLowercase(Object o) {
       return o.toString().toLowerCase(Locale.US);
     }
   }
 </code></pre>

 <p>Type adapter factories select which types they provide type adapters
 for. If a factory cannot support a given type, it must return null when
 that type is passed to <A HREF="../../../../../../com/netmera/mobile/util/google/gson/TypeAdapterFactory.html#create(com.netmera.mobile.util.google.gson.Gson, com.netmera.mobile.util.google.gson.reflect.TypeToken)"><CODE>create(com.netmera.mobile.util.google.gson.Gson, com.netmera.mobile.util.google.gson.reflect.TypeToken<T>)</CODE></A>. Factories should expect <code>create()</code> to be called on them for many types and should return null for
 most of those types. In the above example the factory returns null for
 calls to <code>create()</code> where <code>type</code> is not an enum.

 <p>A factory is typically called once per type, but the returned type
 adapter may be used many times. It is most efficient to do expensive work
 like reflection in <code>create()</code> so that the type adapter's <code>read()</code> and <code>write()</code> methods can be very fast. In this example the
 mapping from lowercase name to enum value is computed eagerly.

 <p>As with type adapters, factories must be <i>registered</i> with a <A HREF="../../../../../../com/netmera/mobile/util/google/gson/GsonBuilder.html" title="class in com.netmera.mobile.util.google.gson"><CODE>GsonBuilder</CODE></A> for them to take effect: <pre>   <code>GsonBuilder builder = new GsonBuilder();
  builder.registerTypeAdapterFactory(new LowercaseEnumTypeAdapterFactory());
  ...
  Gson gson = builder.create();
 </code></pre>
 If multiple factories support the same type, the factory registered earlier
 takes precedence.

 <h3>Example: composing other type adapters</h3>
 In this example we implement a factory for Guava's <code>Multiset</code>
 collection type. The factory can be used to create type adapters for
 multisets of any element type: the type adapter for <code>Multiset&lt;String&gt;</code> is different from the type adapter for <code>Multiset&lt;URL&gt;</code>.

 <p>The type adapter <i>delegates</i> to another type adapter for the
 multiset elements. It figures out the element type by reflecting on the
 multiset's type token. A <code>Gson</code> is passed in to <code>create</code> for
 just this purpose: <pre>   <code>public class MultisetTypeAdapterFactory implements TypeAdapter.Factory {
     public &lt;T&gt; TypeAdapter&lt;T&gt; create(Gson gson, TypeToken&lt;T&gt; typeToken) {
       Type type = typeToken.getType();
       if (typeToken.getRawType() != Multiset.class
           || !(type instanceof ParameterizedType)) {
         return null;
       }

       Type elementType = ((ParameterizedType) type).getActualTypeArguments()[0];
       TypeAdapter&lt;?&gt; elementAdapter = gson.getAdapter(TypeToken.get(elementType));
       return (TypeAdapter&lt;T&gt;) newMultisetAdapter(elementAdapter);
     }

     private &lt;E&gt; TypeAdapter&lt;Multiset&lt;E&gt;&gt; newMultisetAdapter(
         final TypeAdapter&lt;E&gt; elementAdapter) {
       return new TypeAdapter&lt;Multiset&lt;E&gt;&gt;() {
         public void write(JsonWriter out, Multiset&lt;E&gt; value) throws IOException {
           if (value == null) {
             out.nullValue();
             return;
           }

           out.beginArray();
           for (Multiset.Entry&lt;E&gt; entry : value.entrySet()) {
             out.value(entry.getCount());
             elementAdapter.write(out, entry.getElement());
           }
           out.endArray();
         }

         public Multiset&lt;E&gt; read(JsonReader in) throws IOException {
           if (in.peek() == JsonToken.NULL) {
             in.nextNull();
             return null;
           }

           Multiset&lt;E&gt; result = LinkedHashMultiset.create();
           in.beginArray();
           while (in.hasNext()) {
             int count = in.nextInt();
             E element = elementAdapter.read(in);
             result.add(element, count);
           }
           in.endArray();
           return result;
         }
       };
     }
   }
 </code></pre>
 Delegating from one type adapter to another is extremely powerful; it's
 the foundation of how Gson converts Java objects and collections. Whenever
 possible your factory should retrieve its delegate type adapter in the
 <code>create()</code> method; this ensures potentially-expensive type adapter
 creation happens only once.
<P>

<P>
<DL>
<DT><B>Since:</B></DT>
  <DD>2.1</DD>
</DL>
<HR>

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" SUMMARY="">
<TR ALIGN="right" VALIGN="">
<TD NOWRAP><FONT SIZE="-1">
<CODE>&lt;T&gt; <A HREF="../../../../../../com/netmera/mobile/util/google/gson/TypeAdapter.html" title="class in com.netmera.mobile.util.google.gson">TypeAdapter</A>&lt;T&gt;</CODE></FONT></TD>
</TR>
</TABLE>
</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/netmera/mobile/util/google/gson/TypeAdapterFactory.html#create(com.netmera.mobile.util.google.gson.Gson, com.netmera.mobile.util.google.gson.reflect.TypeToken)">create</A></B>(<A HREF="../../../../../../com/netmera/mobile/util/google/gson/Gson.html" title="class in com.netmera.mobile.util.google.gson">Gson</A>&nbsp;gson,
       <A HREF="../../../../../../com/netmera/mobile/util/google/gson/reflect/TypeToken.html" title="class in com.netmera.mobile.util.google.gson.reflect">TypeToken</A>&lt;T&gt;&nbsp;type)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a type adapter for <code>type</code>, or null if this factory doesn't
 support <code>type</code>.</TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="create(com.netmera.mobile.util.google.gson.Gson, com.netmera.mobile.util.google.gson.reflect.TypeToken)"><!-- --></A><H3>
create</H3>
<PRE>
&lt;T&gt; <A HREF="../../../../../../com/netmera/mobile/util/google/gson/TypeAdapter.html" title="class in com.netmera.mobile.util.google.gson">TypeAdapter</A>&lt;T&gt; <B>create</B>(<A HREF="../../../../../../com/netmera/mobile/util/google/gson/Gson.html" title="class in com.netmera.mobile.util.google.gson">Gson</A>&nbsp;gson,
                          <A HREF="../../../../../../com/netmera/mobile/util/google/gson/reflect/TypeToken.html" title="class in com.netmera.mobile.util.google.gson.reflect">TypeToken</A>&lt;T&gt;&nbsp;type)</PRE>
<DL>
<DD>Returns a type adapter for <code>type</code>, or null if this factory doesn't
 support <code>type</code>.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>

<HR>

</BODY>
</HTML>
